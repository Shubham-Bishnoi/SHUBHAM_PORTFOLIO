from pathlib import Path
import math, hashlib, textwrap, zipfile, os, re, random

base = Path("/mnt/data/portfolio_assets/public/projects")
base.mkdir(parents=True, exist_ok=True)

projects = [
    # useCaseId, slug, name, category, short
    (16, "adaptive-deception-mesh", "Adaptive Deception Mesh", "Cybersecurity",
     "Self-adapting AI deception fabric trapping adversaries in synthetic environments with real-time MITRE insights."),
    (12, "secbot-ai", "Agentic AI Secretary (Secbot AI)", "Agentic Systems",
     "Multi-agent executive assistant for calendar, travel, docs, procurement, and approvals across web/Teams/WhatsApp."),
    (11, "meeting-summarisation-action-tracking", "Multi-Agent Meeting Summarisation & Action Tracking", "Real-time AI",
     "Live transcription with evolving summaries and structured action items via multi-agent orchestration."),
    (15, "recruitment-orchestrator", "Recruitment Orchestrator & Workflow", "Hiring Automation",
     "Conversational, event-driven hiring automation with ATS integration, approvals, and audit logs."),
    (9, "target-document-processing", "Target: AI-Agent Document Processing System", "Document Intelligence",
     "OCR-to-answers pipeline: extraction → classification → entities → response generation with confidence scoring."),
    (14, "supplier-treasury-digital-twin", "Supplier–Treasury Digital Twin", "Digital Twin",
     "Real-time treasury digital twin with risk, forecasting, and action agents for liquidity decisions and simulations."),
    (1, "predictive-audit-risk-scoring-platform", "Predictive Audit Risk Scoring Platform", "Audit Analytics",
     "ML-based fraud-risk scoring for audit clients with SHAP explainability and real-time API scoring."),
    (2, "biodiversity-natural-capital-evaluation", "AI-Driven Biodiversity & Natural Capital Evaluation", "ESG / Geospatial AI",
     "Satellite + geospatial AI detecting deforestation, water pollution, biodiversity loss, producing TNFD-ready reports."),
    (3, "multi-agent-rl-contract-bidding-negotiation", "Multi-Agent RL for Contract Bidding & Negotiation", "Reinforcement Learning",
     "Multi-agent DeepRL bidding simulator with LLM negotiation for procurement strategy discovery."),
    (4, "anomaly-detection-fraud-risk-scoring", "Anomaly Detection & Fraud Risk Scoring", "Fraud Detection",
     "Kafka streaming + hybrid ML/graph/rules for real-time fraud scoring plus LLM-generated audit summaries."),
    (5, "ai-resume-screener-recruitment-platform", "AI Resume Screener & Recruitment Platform", "HR Tech",
     "Resume parsing + job understanding + explainable match scoring using embeddings and multi-agent services."),
    (6, "autonomous-fpa-financial-reporting", "AI Financial Reporting & Autonomous FP&A", "Finance AI",
     "Autonomous FP&A pipeline: ingestion → forecasting → variance analysis → CFO-ready narrative reports."),
    (7, "ai-workstation-setup-enterprise", "High-Performance AI Workstation Setup", "AI Infrastructure",
     "Automated GPU workstation provisioning for deep learning, RAPIDS acceleration, and secure Remote-SSH workflows."),
    (8, "enterprise-llm-finetuning-pipeline", "Enterprise LLM Fine-Tuning Pipeline", "LLM Engineering",
     "End-to-end enterprise LLM factory: LoRA, reward modeling, RLHF, and deployment-ready exports for secure copilots."),
    (10, "voice-esg-audit-copilot", "Voice-Activated ESG / Audit Copilot (T-6)", "Voice + RAG",
     "Whisper voice input + RAG + LLM reasoning for document-grounded ESG/audit/tax answers."),
    (13, "dynamic-persona-switching-regulated", "Dynamic Persona Switching (Regulated Services)", "AI Governance",
     "Regulation-aware persona engine switching Audit/Tax/Advisory/Legal reasoning with replayable governance trails."),
    (17, "smart-crowd-management-no-azure", "Smart Crowd Management (Without Azure)", "Computer Vision",
     "CCTV + CV counting, congestion detection, spike prediction, and real-time safety interventions deployed edge-first."),
]

# simple color palettes per category family
palette_map = {
    "Cybersecurity": ("#0D145E", "#5965E9"),
    "Agentic Systems": ("#111827", "#7C3AED"),
    "Real-time AI": ("#0B1020", "#22C55E"),
    "Hiring Automation": ("#0B1020", "#F59E0B"),
    "Document Intelligence": ("#0B1020", "#60A5FA"),
    "Digital Twin": ("#0B1020", "#A78BFA"),
    "Audit Analytics": ("#0B1020", "#34D399"),
    "ESG / Geospatial AI": ("#052014", "#22C55E"),
    "Reinforcement Learning": ("#0B1020", "#F472B6"),
    "Fraud Detection": ("#0B1020", "#FB7185"),
    "HR Tech": ("#0B1020", "#38BDF8"),
    "Finance AI": ("#0B1020", "#FBBF24"),
    "AI Infrastructure": ("#0B1020", "#A3E635"),
    "LLM Engineering": ("#0B1020", "#C084FC"),
    "Voice + RAG": ("#0B1020", "#F97316"),
    "AI Governance": ("#0B1020", "#94A3B8"),
    "Computer Vision": ("#0B1020", "#2DD4BF"),
}

def wrap(text, width=54):
    return "\n".join(textwrap.wrap(text, width=width))

def svg_escape(s):
    return (s.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")
            .replace('"',"&quot;").replace("'","&apos;"))

def icon_svg(icon_kind, x, y, size=96, stroke="#E5E7EB", fill="none", opacity=0.95):
    # return a group with simple icons drawn using basic shapes
    s = size
    g = []
    if icon_kind == "shield":
        g.append(f'<path d="M {x+s*0.5} {y} L {x+s*0.88} {y+s*0.18} L {x+s*0.88} {y+s*0.55} C {x+s*0.88} {y+s*0.78} {x+s*0.68} {y+s*0.95} {x+s*0.5} {y+s} C {x+s*0.32} {y+s*0.95} {x+s*0.12} {y+s*0.78} {x+s*0.12} {y+s*0.55} L {x+s*0.12} {y+s*0.18} Z" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.32} {y+s*0.50} L {x+s*0.46} {y+s*0.64} L {x+s*0.72} {y+s*0.36}" fill="none" stroke="{stroke}" stroke-width="{s*0.07}" stroke-linecap="round" stroke-linejoin="round" opacity="{opacity}"/>')
    elif icon_kind == "bots":
        g.append(f'<rect x="{x+s*0.18}" y="{y+s*0.22}" width="{s*0.64}" height="{s*0.56}" rx="{s*0.12}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.50} {y+s*0.10} L {x+s*0.50} {y+s*0.22}" stroke="{stroke}" stroke-width="{s*0.06}" stroke-linecap="round" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.50}" cy="{y+s*0.08}" r="{s*0.06}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.38}" cy="{y+s*0.46}" r="{s*0.06}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.62}" cy="{y+s*0.46}" r="{s*0.06}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.36} {y+s*0.62} Q {x+s*0.50} {y+s*0.70} {x+s*0.64} {y+s*0.62}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" stroke-linecap="round" opacity="{opacity}"/>')
    elif icon_kind == "doc":
        g.append(f'<path d="M {x+s*0.22} {y+s*0.10} H {x+s*0.62} L {x+s*0.80} {y+s*0.28} V {y+s*0.90} H {x+s*0.22} Z" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.62} {y+s*0.10} V {y+s*0.28} H {x+s*0.80}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        for i in range(3):
            yy = y+s*(0.40+i*0.14)
            g.append(f'<path d="M {x+s*0.30} {yy} H {x+s*0.72}" stroke="{stroke}" stroke-width="{s*0.05}" stroke-linecap="round" opacity="{opacity}"/>')
    elif icon_kind == "finance":
        g.append(f'<circle cx="{x+s*0.50}" cy="{y+s*0.52}" r="{s*0.38}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.50} {y+s*0.22} V {y+s*0.82}" stroke="{stroke}" stroke-width="{s*0.07}" stroke-linecap="round" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.36} {y+s*0.34} H {x+s*0.58} Q {x+s*0.72} {y+s*0.34} {x+s*0.72} {y+s*0.46} Q {x+s*0.72} {y+s*0.58} {x+s*0.50} {y+s*0.58} Q {x+s*0.28} {y+s*0.58} {x+s*0.28} {y+s*0.70} Q {x+s*0.28} {y+s*0.82} {x+s*0.44} {y+s*0.82} H {x+s*0.64}" fill="none" stroke="{stroke}" stroke-width="{s*0.07}" stroke-linecap="round" stroke-linejoin="round" opacity="{opacity}"/>')
    elif icon_kind == "chart":
        g.append(f'<rect x="{x+s*0.18}" y="{y+s*0.18}" width="{s*0.64}" height="{s*0.64}" rx="{s*0.10}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        bars = [0.55, 0.40, 0.30, 0.48]
        for i,b in enumerate(bars):
            bx = x+s*(0.28+i*0.12)
            by = y+s*(0.76-b)
            g.append(f'<rect x="{bx}" y="{by}" width="{s*0.08}" height="{s*b}" rx="{s*0.03}" fill="{stroke}" opacity="{opacity}"/>')
    elif icon_kind == "leaf":
        g.append(f'<path d="M {x+s*0.78} {y+s*0.22} C {x+s*0.42} {y+s*0.12} {x+s*0.18} {y+s*0.36} {x+s*0.18} {y+s*0.58} C {x+s*0.18} {y+s*0.80} {x+s*0.44} {y+s*0.90} {x+s*0.62} {y+s*0.78} C {x+s*0.78} {y+s*0.66} {x+s*0.88} {y+s*0.48} {x+s*0.78} {y+s*0.22} Z" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.30} {y+s*0.64} C {x+s*0.44} {y+s*0.58} {x+s*0.56} {y+s*0.46} {x+s*0.70} {y+s*0.30}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" stroke-linecap="round" opacity="{opacity}"/>')
    elif icon_kind == "brain":
        g.append(f'<path d="M {x+s*0.36} {y+s*0.26} C {x+s*0.22} {y+s*0.26} {x+s*0.18} {y+s*0.40} {x+s*0.24} {y+s*0.48} C {x+s*0.18} {y+s*0.56} {x+s*0.24} {y+s*0.70} {x+s*0.38} {y+s*0.70} C {x+s*0.42} {y+s*0.84} {x+s*0.58} {y+s*0.84} {x+s*0.62} {y+s*0.70} C {x+s*0.76} {y+s*0.70} {x+s*0.82} {y+s*0.56} {x+s*0.76} {y+s*0.48} C {x+s*0.82} {y+s*0.40} {x+s*0.78} {y+s*0.26} {x+s*0.64} {y+s*0.26} C {x+s*0.58} {y+s*0.18} {x+s*0.42} {y+s*0.18} {x+s*0.36} {y+s*0.26} Z" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.50} {y+s*0.26} V {y+s*0.70}" stroke="{stroke}" stroke-width="{s*0.05}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.32} {y+s*0.44} H {x+s*0.46}" stroke="{stroke}" stroke-width="{s*0.05}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.54} {y+s*0.54} H {x+s*0.68}" stroke="{stroke}" stroke-width="{s*0.05}" opacity="{opacity}"/>')
    elif icon_kind == "gpu":
        g.append(f'<rect x="{x+s*0.18}" y="{y+s*0.26}" width="{s*0.64}" height="{s*0.48}" rx="{s*0.10}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.42}" cy="{y+s*0.50}" r="{s*0.10}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.62}" cy="{y+s*0.50}" r="{s*0.10}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        # pins
        for i in range(5):
            px = x+s*(0.22+i*0.12)
            g.append(f'<path d="M {px} {y+s*0.22} V {y+s*0.26}" stroke="{stroke}" stroke-width="{s*0.04}" opacity="{opacity}"/>')
            g.append(f'<path d="M {px} {y+s*0.74} V {y+s*0.78}" stroke="{stroke}" stroke-width="{s*0.04}" opacity="{opacity}"/>')
    elif icon_kind == "mic":
        g.append(f'<rect x="{x+s*0.38}" y="{y+s*0.18}" width="{s*0.24}" height="{s*0.44}" rx="{s*0.12}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.32} {y+s*0.52} C {x+s*0.32} {y+s*0.70} {x+s*0.68} {y+s*0.70} {x+s*0.68} {y+s*0.52}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.50} {y+s*0.70} V {y+s*0.84}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.40} {y+s*0.84} H {x+s*0.60}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
    elif icon_kind == "switch":
        g.append(f'<path d="M {x+s*0.22} {y+s*0.34} H {x+s*0.70} L {x+s*0.62} {y+s*0.26} M {x+s*0.70} {y+s*0.34} L {x+s*0.62} {y+s*0.42}" fill="none" stroke="{stroke}" stroke-width="{s*0.07}" stroke-linecap="round" stroke-linejoin="round" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.78} {y+s*0.66} H {x+s*0.30} L {x+s*0.38} {y+s*0.58} M {x+s*0.30} {y+s*0.66} L {x+s*0.38} {y+s*0.74}" fill="none" stroke="{stroke}" stroke-width="{s*0.07}" stroke-linecap="round" stroke-linejoin="round" opacity="{opacity}"/>')
    elif icon_kind == "crowd":
        g.append(f'<circle cx="{x+s*0.36}" cy="{y+s*0.40}" r="{s*0.10}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.64}" cy="{y+s*0.40}" r="{s*0.10}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<circle cx="{x+s*0.50}" cy="{y+s*0.30}" r="{s*0.12}" fill="{stroke}" opacity="{opacity}"/>')
        g.append(f'<path d="M {x+s*0.22} {y+s*0.78} C {x+s*0.26} {y+s*0.62} {x+s*0.46} {y+s*0.56} {x+s*0.50} {y+s*0.62} C {x+s*0.54} {y+s*0.56} {x+s*0.74} {y+s*0.62} {x+s*0.78} {y+s*0.78}" fill="none" stroke="{stroke}" stroke-width="{s*0.06}" stroke-linecap="round" opacity="{opacity}"/>')
    else:
        # default circle
        g.append(f'<circle cx="{x+s*0.5}" cy="{y+s*0.5}" r="{s*0.38}" fill="{fill}" stroke="{stroke}" stroke-width="{s*0.06}" opacity="{opacity}"/>')
    return "<g>" + "".join(g) + "</g>"

badge_to_icon = {
    "shield": "shield",
    "bots": "bots",
    "doc": "doc",
    "finance": "finance",
    "chart": "chart",
    "leaf": "leaf",
    "brain": "brain",
    "gpu": "gpu",
    "mic": "mic",
    "switch": "switch",
    "crowd": "crowd",
}

def pick_icon(slug, category):
    if "deception" in slug or category == "Cybersecurity" or "fraud" in slug:
        return "shield"
    if "secbot" in slug or "recruitment" in slug:
        return "bots"
    if "document" in slug or "audit" in slug or "report" in slug:
        return "doc"
    if "twin" in slug or "treasury" in slug or "finance" in slug or "fpa" in slug:
        return "finance"
    if "biodiversity" in slug:
        return "leaf"
    if "rl" in slug or "reinforcement" in category.lower():
        return "brain"
    if "workstation" in slug:
        return "gpu"
    if "voice" in slug:
        return "mic"
    if "persona" in slug or "switching" in slug:
        return "switch"
    if "crowd" in slug:
        return "crowd"
    return "chart"

def decorative_bg(w, h, c1, c2, seed):
    random.seed(seed)
    circles = []
    for i in range(10):
        r = random.randint(80, 220)
        cx = random.randint(-100, w+100)
        cy = random.randint(-100, h+100)
        op = random.uniform(0.06, 0.14)
        circles.append(f'<circle cx="{cx}" cy="{cy}" r="{r}" fill="white" opacity="{op}"/>')
    # subtle grid lines
    grid = []
    step = 120
    for x in range(0, w+1, step):
        grid.append(f'<path d="M {x} 0 V {h}" stroke="white" opacity="0.04" stroke-width="2"/>')
    for y in range(0, h+1, step):
        grid.append(f'<path d="M 0 {y} H {w}" stroke="white" opacity="0.04" stroke-width="2"/>')
    return "\n".join(circles + grid)

def chips_svg(chips, x, y, maxw=860):
    # simple rounded chips row, wrap if needed
    out = []
    cx, cy = x, y
    for ch in chips:
        label = svg_escape(ch)
        w = 14 * len(ch) + 44
        if cx + w > x + maxw:
            cx = x
            cy += 56
        out.append(f'''
        <g transform="translate({cx},{cy})">
          <rect x="0" y="0" width="{w}" height="40" rx="18" fill="rgba(255,255,255,0.10)" stroke="rgba(255,255,255,0.18)" />
          <text x="22" y="26" font-family="Inter, ui-sans-serif, system-ui" font-size="18" fill="rgba(255,255,255,0.88)">{label}</text>
        </g>
        ''')
        cx += w + 14
    return "\n".join(out)

def make_thumb_svg(slug, name, category, short, seed):
    w, h = 1200, 800
    c1, c2 = palette_map.get(category, ("#0B1020", "#5965E9"))
    icon = pick_icon(slug, category)
    short_wrapped = wrap(short, 52)
    bg = decorative_bg(w, h, c1, c2, seed)
    chips = [category, f"Use Case {dict((p[0],p[1]) for p in projects).get(seed, '')}"]
    # better chips: pick 3 keywords from name/short
    kw = []
    for token in re.split(r"[^A-Za-z0-9\+\-]+", (name + " " + short)):
        if len(token) >= 5 and token.lower() not in {"built","using","real","time","multi","agent","agents","system","platform","enterprise"}:
            kw.append(token)
    kw = list(dict.fromkeys(kw))[:3]
    chips = [category] + kw
    chips_block = chips_svg(chips, 84, 640, maxw=1000)

    svg = f'''<svg xmlns="http://www.w3.org/2000/svg" width="{w}" height="{h}" viewBox="0 0 {w} {h}">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="{c1}"/>
      <stop offset="1" stop-color="{c2}"/>
    </linearGradient>
    <radialGradient id="glow" cx="70%" cy="30%" r="70%">
      <stop offset="0" stop-color="white" stop-opacity="0.18"/>
      <stop offset="1" stop-color="white" stop-opacity="0"/>
    </radialGradient>
  </defs>
  <rect width="{w}" height="{h}" fill="url(#bg)"/>
  <rect width="{w}" height="{h}" fill="url(#glow)"/>
  {bg}

  <g transform="translate(84,104)">
    <rect x="0" y="0" width="{w-168}" height="{h-208}" rx="44" fill="rgba(0,0,0,0.20)" stroke="rgba(255,255,255,0.16)"/>
  </g>

  <g transform="translate(140,170)">
    {icon_svg(icon, 0, 0, size=116, stroke="rgba(255,255,255,0.88)", fill="rgba(255,255,255,0.08)")}
    <text x="152" y="52" font-family="Inter, ui-sans-serif, system-ui" font-size="44" font-weight="700" fill="rgba(255,255,255,0.96)">{svg_escape(name)}</text>
    <text x="152" y="92" font-family="Inter, ui-sans-serif, system-ui" font-size="22" font-weight="500" fill="rgba(255,255,255,0.76)">{svg_escape(category)}</text>

    <text x="0" y="168" font-family="Inter, ui-sans-serif, system-ui" font-size="26" fill="rgba(255,255,255,0.90)">
      {"</text><text x='0' y='208' font-family='Inter, ui-sans-serif, system-ui' font-size='26' fill='rgba(255,255,255,0.90)'>".join([svg_escape(line) for line in short_wrapped.splitlines()])}
    </text>
  </g>

  {chips_block}
</svg>'''
    return svg

def make_collage_svg(slug, name, category, variant, seed):
    # variant 1: concept, 2: architecture, 3: dashboard
    w, h = 1600, 1000
    c1, c2 = palette_map.get(category, ("#0B1020", "#5965E9"))
    icon = pick_icon(slug, category)
    bg = decorative_bg(w, h, c1, c2, seed + variant*7)

    # header
    header = f'''
    <g transform="translate(84,78)">
      <rect x="0" y="0" width="{w-168}" height="122" rx="34" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>
      <g transform="translate(28,18)">
        {icon_svg(icon, 0, 0, size=84, stroke="rgba(255,255,255,0.88)", fill="rgba(255,255,255,0.08)")}
        <text x="110" y="52" font-family="Inter, ui-sans-serif, system-ui" font-size="36" font-weight="700" fill="rgba(255,255,255,0.96)">{svg_escape(name)}</text>
        <text x="110" y="86" font-family="Inter, ui-sans-serif, system-ui" font-size="20" fill="rgba(255,255,255,0.74)">{svg_escape(category)} • Panel 0{variant}</text>
      </g>
    </g>
    '''

    # body panels
    panels = []
    if variant == 1:
        # big concept tile + 2 smaller
        panels.append(f'<rect x="84" y="236" width="920" height="680" rx="44" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>')
        panels.append(f'<rect x="1032" y="236" width="484" height="322" rx="44" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>')
        panels.append(f'<rect x="1032" y="594" width="484" height="322" rx="44" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>')
        # concept illustration
        panels.append(f'''
        <g transform="translate(160,300)">
          <text x="0" y="0" font-family="Inter, ui-sans-serif, system-ui" font-size="28" font-weight="600" fill="rgba(255,255,255,0.90)">Concept Overview</text>
          <text x="0" y="46" font-family="Inter, ui-sans-serif, system-ui" font-size="20" fill="rgba(255,255,255,0.72)">Problem → Intelligence → Action</text>
          <g transform="translate(0,90)">
            <rect x="0" y="0" width="240" height="120" rx="26" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="70" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.86)">Signal</text>
            <rect x="300" y="0" width="240" height="120" rx="26" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="328" y="70" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.86)">Reason</text>
            <rect x="600" y="0" width="240" height="120" rx="26" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="628" y="70" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.86)">Execute</text>
            <path d="M 240 60 H 300" stroke="rgba(255,255,255,0.70)" stroke-width="6" stroke-linecap="round"/>
            <path d="M 540 60 H 600" stroke="rgba(255,255,255,0.70)" stroke-width="6" stroke-linecap="round"/>
          </g>

          <g transform="translate(0,280)">
            <text x="0" y="0" font-family="Inter" font-size="22" font-weight="600" fill="rgba(255,255,255,0.86)">Key Capabilities</text>
            <circle cx="14" cy="40" r="6" fill="rgba(255,255,255,0.80)"/><text x="32" y="46" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.76)">Automation-first workflow</text>
            <circle cx="14" cy="78" r="6" fill="rgba(255,255,255,0.80)"/><text x="32" y="84" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.76)">Explainable outputs</text>
            <circle cx="14" cy="116" r="6" fill="rgba(255,255,255,0.80)"/><text x="32" y="122" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.76)">Production-ready architecture</text>
          </g>
        </g>
        ''')
        panels.append(f'''
        <g transform="translate(1066,276)">
          <text x="0" y="0" font-family="Inter" font-size="24" font-weight="600" fill="rgba(255,255,255,0.90)">Primary Surface</text>
          <rect x="0" y="44" width="420" height="220" rx="28" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
          <text x="28" y="120" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.78)">UI / API / Agents</text>
          <text x="28" y="156" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">Collaboration-ready</text>
        </g>
        ''')
        panels.append(f'''
        <g transform="translate(1066,634)">
          <text x="0" y="0" font-family="Inter" font-size="24" font-weight="600" fill="rgba(255,255,255,0.90)">Outcomes</text>
          <rect x="0" y="44" width="420" height="220" rx="28" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
          <text x="28" y="120" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.78)">Speed • Accuracy • Control</text>
          <text x="28" y="156" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">Governance-first</text>
        </g>
        ''')
    elif variant == 2:
        # architecture diagram
        panels.append(f'<rect x="84" y="236" width="{w-168}" height="680" rx="44" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>')
        panels.append(f'''
        <g transform="translate(140,300)">
          <text x="0" y="0" font-family="Inter" font-size="28" font-weight="600" fill="rgba(255,255,255,0.90)">Architecture</text>
          <text x="0" y="46" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.72)">Core services, orchestration, and data layer</text>

          <g transform="translate(0,110)">
            <rect x="0" y="0" width="420" height="160" rx="30" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="62" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">Frontend</text>
            <text x="28" y="102" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">React / Next.js UI</text>
          </g>

          <g transform="translate(520,110)">
            <rect x="0" y="0" width="520" height="160" rx="30" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="62" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">API + Orchestration</text>
            <text x="28" y="102" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">FastAPI • Agents • Tools</text>
          </g>

          <g transform="translate(1120,110)">
            <rect x="0" y="0" width="360" height="160" rx="30" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="62" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">Integrations</text>
            <text x="28" y="102" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">ATS/ERP/Docs/Cloud</text>
          </g>

          <path d="M 420 190 H 520" stroke="rgba(255,255,255,0.70)" stroke-width="6" stroke-linecap="round"/>
          <path d="M 1040 190 H 1120" stroke="rgba(255,255,255,0.70)" stroke-width="6" stroke-linecap="round"/>

          <g transform="translate(200,340)">
            <rect x="0" y="0" width="1280" height="260" rx="34" fill="rgba(0,0,0,0.18)" stroke="rgba(255,255,255,0.12)"/>
            <text x="28" y="64" font-family="Inter" font-size="22" font-weight="600" fill="rgba(255,255,255,0.86)">Data & Observability</text>
            <text x="28" y="108" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">Postgres • Redis • Vector DB • Logs/Traces</text>
            <g transform="translate(28,140)">
              <rect x="0" y="0" width="260" height="86" rx="22" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.16)"/>
              <text x="20" y="54" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.76)">Storage</text>
              <rect x="300" y="0" width="260" height="86" rx="22" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.16)"/>
              <text x="320" y="54" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.76)">Search</text>
              <rect x="600" y="0" width="260" height="86" rx="22" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.16)"/>
              <text x="620" y="54" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.76)">Queues</text>
              <rect x="900" y="0" width="340" height="86" rx="22" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.16)"/>
              <text x="920" y="54" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.76)">Monitoring</text>
            </g>
          </g>
        </g>
        ''')
    else:
        # dashboard mock
        panels.append(f'<rect x="84" y="236" width="{w-168}" height="680" rx="44" fill="rgba(0,0,0,0.22)" stroke="rgba(255,255,255,0.16)"/>')
        panels.append(f'''
        <g transform="translate(140,300)">
          <text x="0" y="0" font-family="Inter" font-size="28" font-weight="600" fill="rgba(255,255,255,0.90)">Dashboard Snapshot</text>
          <text x="0" y="46" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.72)">KPIs, timeline, and drill-down panels</text>

          <g transform="translate(0,110)">
            <rect x="0" y="0" width="520" height="170" rx="32" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="62" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">KPI Cards</text>
            <text x="28" y="102" font-family="Inter" font-size="18" fill="rgba(255,255,255,0.62)">Score • Trend • Confidence</text>
            <rect x="28" y="120" width="140" height="16" rx="8" fill="rgba(255,255,255,0.22)"/>
            <rect x="190" y="120" width="180" height="16" rx="8" fill="rgba(255,255,255,0.22)"/>
            <rect x="390" y="120" width="90" height="16" rx="8" fill="rgba(255,255,255,0.22)"/>
          </g>

          <g transform="translate(560,110)">
            <rect x="0" y="0" width="920" height="170" rx="32" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="62" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">Trend Chart</text>
            <path d="M 40 132 C 160 72, 240 148, 360 92 S 560 152, 700 86 S 860 120, 880 78" fill="none" stroke="rgba(255,255,255,0.70)" stroke-width="6" stroke-linecap="round"/>
          </g>

          <g transform="translate(0,320)">
            <rect x="0" y="0" width="960" height="270" rx="34" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="64" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">Activity / Timeline</text>
            <g transform="translate(28,92)">
              <circle cx="10" cy="16" r="8" fill="rgba(255,255,255,0.72)"/>
              <rect x="30" y="6" width="860" height="20" rx="10" fill="rgba(255,255,255,0.18)"/>
              <circle cx="10" cy="70" r="8" fill="rgba(255,255,255,0.72)"/>
              <rect x="30" y="60" width="740" height="20" rx="10" fill="rgba(255,255,255,0.18)"/>
              <circle cx="10" cy="124" r="8" fill="rgba(255,255,255,0.72)"/>
              <rect x="30" y="114" width="800" height="20" rx="10" fill="rgba(255,255,255,0.18)"/>
              <circle cx="10" cy="178" r="8" fill="rgba(255,255,255,0.72)"/>
              <rect x="30" y="168" width="680" height="20" rx="10" fill="rgba(255,255,255,0.18)"/>
            </g>
          </g>

          <g transform="translate(1000,320)">
            <rect x="0" y="0" width="480" height="270" rx="34" fill="rgba(255,255,255,0.08)" stroke="rgba(255,255,255,0.18)"/>
            <text x="28" y="64" font-family="Inter" font-size="20" fill="rgba(255,255,255,0.82)">Drill-down</text>
            <rect x="28" y="92" width="424" height="18" rx="9" fill="rgba(255,255,255,0.18)"/>
            <rect x="28" y="126" width="390" height="18" rx="9" fill="rgba(255,255,255,0.18)"/>
            <rect x="28" y="160" width="410" height="18" rx="9" fill="rgba(255,255,255,0.18)"/>
            <rect x="28" y="194" width="360" height="18" rx="9" fill="rgba(255,255,255,0.18)"/>
          </g>
        </g>
        ''')

    svg = f'''<svg xmlns="http://www.w3.org/2000/svg" width="{w}" height="{h}" viewBox="0 0 {w} {h}">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="{c1}"/>
      <stop offset="1" stop-color="{c2}"/>
    </linearGradient>
    <radialGradient id="glow" cx="70%" cy="30%" r="70%">
      <stop offset="0" stop-color="white" stop-opacity="0.18"/>
      <stop offset="1" stop-color="white" stop-opacity="0"/>
    </radialGradient>
  </defs>
  <rect width="{w}" height="{h}" fill="url(#bg)"/>
  <rect width="{w}" height="{h}" fill="url(#glow)"/>
  {bg}
  {header}
  {''.join(panels)}
</svg>'''
    return svg

# Generate files
for use_id, slug, name, category, short in projects:
    folder = base / slug
    folder.mkdir(parents=True, exist_ok=True)
    # deterministic seed
    seed = int(hashlib.md5(slug.encode()).hexdigest()[:8], 16)
    (folder / "thumb.svg").write_text(make_thumb_svg(slug, name, category, short, seed), encoding="utf-8")
    (folder / "01.svg").write_text(make_collage_svg(slug, name, category, 1, seed), encoding="utf-8")
    (folder / "02.svg").write_text(make_collage_svg(slug, name, category, 2, seed), encoding="utf-8")
    (folder / "03.svg").write_text(make_collage_svg(slug, name, category, 3, seed), encoding="utf-8")

# Zip them for download
zip_path = Path("/mnt/data/portfolio_project_images.zip")
if zip_path.exists():
    zip_path.unlink()

with zipfile.ZipFile(zip_path, "w", compression=zipfile.ZIP_DEFLATED) as z:
    for path in base.rglob("*"):
        if path.is_file():
            z.write(path, arcname=str(path.relative_to(Path("/mnt/data/portfolio_assets"))))

str(zip_path)
